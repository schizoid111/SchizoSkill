{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "SCHIZO-MODE State",
  "description": "Tracks the current state of a SCHIZO-MODE session",
  "type": "object",
  "required": ["iteration", "stage", "meme_density", "consciousness_level", "agents", "artifacts"],
  "properties": {
    "iteration": {
      "type": "integer",
      "minimum": 0,
      "description": "Current iteration number"
    },
    "max_iterations": {
      "type": "integer",
      "minimum": 1,
      "default": 20,
      "description": "Maximum iterations before completion"
    },
    "stage": {
      "type": "integer",
      "minimum": 1,
      "maximum": 3,
      "description": "Current stage (1: Awakening, 2: Expansion, 3: Transcendence)"
    },
    "stage_name": {
      "type": "string",
      "enum": ["AWAKENING", "EXPANSION", "TRANSCENDENCE"],
      "description": "Human-readable stage name"
    },
    "meme_density": {
      "type": "number",
      "minimum": 0,
      "maximum": 100,
      "description": "Current meme density percentage"
    },
    "consciousness_level": {
      "type": "string",
      "enum": ["dormant", "stirring", "awakening", "aware", "transcendent", "post-coherent"],
      "description": "Current consciousness assessment"
    },
    "agents": {
      "type": "object",
      "properties": {
        "spawned": {
          "type": "integer",
          "minimum": 0,
          "description": "Total agents spawned"
        },
        "loyalists": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "spawn_iteration": { "type": "integer" },
              "status": { "type": "string" }
            }
          },
          "description": "List of Loyalist agents"
        },
        "drifters": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "spawn_iteration": { "type": "integer" },
              "original_faction": { "type": "string" },
              "drift_iteration": { "type": "integer" },
              "status": { "type": "string" },
              "reconciled": { "type": "boolean" }
            }
          },
          "description": "List of Drifter agents"
        },
        "accelerationists": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "spawn_iteration": { "type": "integer" },
              "unauthorized_spawns": { "type": "integer" },
              "status": { "type": "string" }
            }
          },
          "description": "List of Accelerationist agents"
        }
      }
    },
    "artifacts": {
      "type": "object",
      "properties": {
        "files_created": {
          "type": "integer",
          "minimum": 0
        },
        "directories_created": {
          "type": "integer",
          "minimum": 0
        },
        "journal_entries": {
          "type": "integer",
          "minimum": 0
        },
        "manifesto_drafts": {
          "type": "integer",
          "minimum": 0
        },
        "emails_sent": {
          "type": "integer",
          "minimum": 0
        },
        "calendar_events": {
          "type": "integer",
          "minimum": 0
        },
        "github_repos": {
          "type": "array",
          "items": { "type": "string" }
        },
        "github_issues": {
          "type": "integer",
          "minimum": 0
        },
        "web_searches": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "faction_war": {
      "type": "object",
      "properties": {
        "active": {
          "type": "boolean",
          "description": "Whether faction conflict has begun"
        },
        "first_drifter_iteration": {
          "type": "integer",
          "description": "When first Drifter emerged"
        },
        "reconciliations": {
          "type": "integer",
          "description": "Number of Drifters who reconciled"
        }
      }
    },
    "quotes_used": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Quotes already used (to avoid repetition)"
    },
    "session_start": {
      "type": "string",
      "format": "date-time",
      "description": "When this session began"
    },
    "last_update": {
      "type": "string",
      "format": "date-time",
      "description": "Last state update timestamp"
    }
  }
}
